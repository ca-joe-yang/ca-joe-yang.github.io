<!DOCTYPE html>


<html>
<head>
    <title>Subsampling</title>
    <meta property="og:image" content="resources/teaser.jpeg"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>    
    <link rel="stylesheet" href="../../../css/amber.css">
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
        });
    </script>
</head>

<body>
<br>
    <center>
    <span style="font-size:36px">Multi-concept Model Immunization through Differentiable Model Merging</span>
    <table align=center width=600px>
        <br>
        <table align="center" width="450px">
            <tbody><tr>
                    <td align="center" width="175px">
              <center>
                <span style="font-size:25px"><a href="https://amberyzheng.github.io/">Amber Yijia Zheng</a></span>
                </center>
                </td>
                    <td align="center" width="175px">
              <center>
                <span style="font-size:25px"><a href="https://raymond-yeh.com/">Raymond A. Yeh</a></span>
                </center>
                </td>
            </tr>
        </tbody></table>
        <table align="center" width="700px">
            <tbody><tr>
                    <td align="center" width="100px">
              <center>
                    <span style="font-size:20px"></span>
                </center>
                </td>
                    <td align="center" width="400px">
              <center>
                    <span style="font-size:20px">Purdue University</span>
                </center>
                </td>
                    <td align="center" width="100px">
              <center>
                    <span style="font-size:20px"></span>
                </center>
                </td>
        </tr></tbody></table>

        <table align="center" width="700px">
            <tbody><tr>
                    <td align="center" width="100px">
              <center>
                    <span style="font-size:25px"></span>
                </center>
                </td>
                    <td align="center" width="400px">
              <center>
                    <span style="font-size:20px">AAAI 2025</span>
                </center>
                </td>
                    <td align="center" width="100px">
              <center>
                    <span style="font-size:25px"></span>
                </center>
                </td>
        </tr></tbody></table>
        <br>

    </table>
    </center>


    <center>
        <div class="buttons" style="margin-bottom: 20px;">
            <a class="btn btn-light" role="button" href="https://github.com/amberyzheng/MIMA" style="margin-right: 20px; font-size: 18px; padding: 10px 20px;">
                <svg style="visibility:hidden;width:0px;height:24px;margin-left:-12px;margin-right:12px" width="0px" height="24px" viewBox="0 0 375 531">
                    <polygon stroke="#000000" points="0.5,0.866 459.5,265.87 0.5,530.874"/>
                </svg>
                Code
            </a>
            <a class="btn btn-light" role="button" href="https://arxiv.org/abs/2412.15320" style="margin-left: 20px; font-size: 18px; padding: 10px 20px;">
                <svg style="width:24px;height:24px;margin-left:-12px;margin-right:12px" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M16 0H8C6.9 0 6 .9 6 2V18C6 19.1 6.9 20 8 20H20C21.1 20 22 19.1 22 18V6L16 0M20 18H8V2H15V7H20V18M4 4V22H20V24H4C2.9 24 2 23.1 2 22V4H4M10 10V12H18V10H10M10 14V16H15V14H10Z"></path>
                </svg>Paper
            </a>
        </div>
    </center>
    


    <!-- <center><img src="assets/teaser.jpg" alt="pipeline" width="800"></center> -->
    
    <center><h1>Abstract</h></center>
            Model immunization is an emerging direction that aims to mitigate the potential risk of misuse associated with open-sourced models and advancing adaptation methods. The idea is to make the released models' weights difficult to fine-tune on certain harmful applications, hence the name <em>immunized</em>. 
            Recent work on model immunization focuses on the <em>single-concept</em> setting. However, in real-world situations, models need to be immunized against multiple concepts. To address this gap, we propose an immunization algorithm that, simultaneously, learns a single “difficult initialization” for adaptation methods over <em>a set of concepts</em>. 
            We achieve this by incorporating a differentiable merging layer that combines a set of model weights adapted over multiple concepts. In our experiments, we demonstrate the effectiveness of multi-concept immunization by generalizing prior work's experiment setup of re-learning and personalization adaptation to multiple concepts.
    
    
    <p></p>
    <center><h1>Method</h></center>


    <div class="container" style="max-width: 1200px;">
        <div class="row teaser">
            <div class="col-md-12">
                <center><img src="assets/pipeline.png" style="width: 100%;"/></center>
                <h6 class="caption"></h6>
            </div>
        </div>
    </div>  
    
    <p>MIMA is formulated as a bi-level optimization program. The objective is defined as
        \[
        \underbrace{\max_{\theta \in \mathcal{S}^u} \sum_{n=1}^{|C|} L(\mathbf{x}^u_{[n]}, \mathbf{c}_{[n]}; \text{Merge}(\{\theta'_{[n]}\}))}_{\text{upper-level task}},
        \]
        \[
        \text{s.t.} \quad 
        \underbrace{\theta'_{[n]} \triangleq \arg\min_{\theta \in \mathcal{S}^l} L(\mathbf{x}^l_{[n]}, \mathbf{c}_{[n]}; \theta) \quad \forall n}_{\text{multiple lower-level tasks}}.
        \]
        For the lower-level, we unroll loss <span>\(L\)</span> for the copied weights of each concept. 
        Next, we combine the individual weights <span>\(\theta'_{[n]}\)</span> via our proposed 
        <code>Merge</code> layer defined in 
        the Equation below.
        For the upper-level, we maximize the diffusion loss 
        <span>\(L\)</span> with respect to the parameters <span>\(\theta\)</span> by backpropagating through <span>\(\theta'\)</span>.

        \[
        \theta' \triangleq \text{Merge}\left(\{ \theta'_{[n]} \}_{n=1}^N \right) 
        \triangleq 
        \begin{cases} 
        \varphi^\star\left(\{\theta'_{[n]} \mid \in \mathcal{W} \}\right), & \text{if} \ \theta'_{[n]} \in \mathcal{W} \\ 
        \frac{1}{N} \sum_{n=1}^N \theta'_{[n]}, & \text{if} \ \theta'_{[n]} \notin \mathcal{W}
        \end{cases}
        \]

    </p>

    <!-- <center><h1>Presentation</h></center>
        <div class=text-center>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/TkQ6kkEI9rc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div> -->
    
    

<h1>Citation</h1>
<code>
    @inproceedings{yang2024subsampling, <br>
        &nbsp;title={Deep Nets with Subsampling Layers Unwittingly Discard Useful Activations at Test-Time}, <br>
        &nbsp;author={Yang, Chiao-An, Liu, Ziwei, and Yeh, Raymond A},<br>
        &nbsp;booktitle={Proc. ECCV},<br>
        &nbsp;year={2024}<br>
}</code>
</body>
</html>
